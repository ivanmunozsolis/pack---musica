<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Pago | Pack Musical Profesional</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      margin: 0;
      height: 100vh;
      background: radial-gradient(circle at top, #0a1a3a, #020814);
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: Arial, sans-serif;
      color: white;
    }

    .card {
      background: rgba(255,255,255,0.05);
      padding: 40px;
      border-radius: 16px;
      text-align: center;
      box-shadow: 0 0 30px rgba(0,0,0,0.6);
      max-width: 380px;
      width: 90%;
    }

    h1 {
      margin-top: 0;
      font-size: 22px;
    }

    .ok {
      color: #00ff88;
      font-weight: bold;
      margin: 15px 0;
    }

    .error {
      color: #ff5555;
      font-weight: bold;
      margin: 15px 0;
    }

    .btn {
      display: none;
      margin-top: 25px;
      padding: 14px 22px;
      background: linear-gradient(135deg, #00c6ff, #0072ff);
      border: none;
      border-radius: 10px;
      color: white;
      font-size: 16px;
      cursor: pointer;
      text-decoration: none;
      font-weight: bold;
    }

    .btn:hover {
      opacity: 0.9;
    }

    small {
      display: block;
      margin-top: 18px;
      opacity: 0.6;
      font-size: 12px;
    }
  </style>
</head>
<body>

  <div class="card">
    <h1>üéµ Pack Musical Profesional</h1>

    <div id="status">Validando tu pago‚Ä¶</div>

    <a
      id="downloadBtn"
      class="btn"
      href="https://drive.google.com/drive/folders/1LbGhbOXX7SSV223LORKR6r_Jxa1gFPv"
      target="_blank"
    >
      ‚¨á Descargar Pack Musical
    </a>

    <small>
      Vendedor: Iv√°n M. Innova Group<br>
      Producto digital ‚Äì no reembolsable
    </small>
  </div>

<script>
(async () => {
  const statusDiv = document.getElementById("status");
  const btn = document.getElementById("downloadBtn");

  const params = new URLSearchParams(window.location.search);
  const paymentId = params.get("payment_id");

  if (!paymentId) {
    statusDiv.innerHTML = "<div class='error'>‚ùå Pago no identificado</div>";
    return;
  }

  try {
    const res = await fetch(
      "https://ivanm-backend-ok.vercel.app/api/verify-payment?payment_id=" + paymentId
    );

    const data = await res.json();

    if (data.approved) {
      statusDiv.innerHTML = "<div class='ok'>‚úÖ Pago aprobado</div>";
      btn.style.display = "inline-block";
    } else {
      statusDiv.innerHTML = "<div class='error'>‚è≥ Pago no aprobado</div>";
    }

  } catch (e) {
    statusDiv.innerHTML = "<div class='error'>‚ùå Error validando el pago</div>";
  }
})();
</script>

</body>
</html>
