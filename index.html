<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Pack Musical Profesional</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="card">
    <h1>ðŸŽµ Pack Musical Profesional</h1>
    <h2>IvÃ¡n M. Innova Group</h2>

    <p>
      âœ” MÃ¡s de 2000 canciones<br />
      âœ” Pack completo (8 GB)<br />
      âœ” Ideal para rockolas, DJs y negocios<br />
      âœ” MÃºsica organizada por gÃ©neros
    </p>

    <!-- BOTÃ“N PAGAR -->
    <button class="btn pay" onclick="pagar()">
      ðŸ’³ Pagar Pack Musical
    </button>

    <!-- BOTÃ“N DESCARGA -->
    <div id="descarga" style="display:none; margin-top:20px;">
      <a
        class="btn"
        href="https://drive.google.com/drive/folders/1LbfrGhbOX7SSV223LQRkR6r_Jxa1gFPv?usp=sharing"
        target="_blank"
      >
        â¬‡ Descargar Pack Musical
      </a>
      <p style="font-size:12px; margin-top:10px;">
        Descarga segura mediante Google Drive
      </p>
    </div>
  </div>

  <script>
    const BACKEND = "https://ivanm-backend-ok.vercel.app";

    async function pagar() {
      try {
        const res = await fetch(`${BACKEND}/api/create-checkout`, {
          method: "POST",
          headers: { "Content-Type": "application/json" }
        });

        const data = await res.json();

        if (data.init_point) {
          window.location.href = data.init_point;
        } else {
          alert("No se pudo iniciar el pago");
        }
      } catch (err) {
        alert("Error de conexiÃ³n con el servidor");
      }
    }

    // VERIFICAR PAGO AL VOLVER
    const params = new URLSearchParams(window.location.search);
    const token = params.get("token");

    if (token) {
      fetch(`${BACKEND}/api/verify-payment?token=${token}`)
        .then(res => res.json())
        .then(data => {
          if (data.valid) {
            document.getElementById("descarga").style.display = "block";
          }
        });
    }
  </script>
</body>
</html>
