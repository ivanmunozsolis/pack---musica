<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Iv√°n M. Innova Group</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>

<body>

<div class="card">
  <h1>üéµ Pack Musical Profesional</h1>
  <h2>Iv√°n M. Innova Group</h2>

  <p>
    ‚úî M√°s de 2000 canciones<br>
    ‚úî Pack completo (8 GB)<br>
    ‚úî Ideal para rockolas, DJs y negocios<br>
    ‚úî M√∫sica organizada por g√©neros
  </p>

  <!-- BOT√ìN DE PAGO -->
  <button class="btn pay" onclick="pagar()">
    üí≥ Pagar Pack Musical
  </button>

  <!-- DESCARGA (OCULTA HASTA VALIDACI√ìN) -->
  <div id="descarga" style="display:none; margin-top:20px;">
    <a class="btn"
       href="https://drive.google.com/drive/folders/https://drive.google.com/drive/folders/1LbfrGhbOX7SSV223L0RkR6r_Jxa1gFPv?usp=sharing"
       target="_blank">
       ‚¨á Descargar Pack Musical
    </a>
    <small>Descarga segura mediante Google Drive</small>
  </div>
</div>

<script>
/* 1Ô∏è‚É£ INICIAR PAGO */
async function pagar() {
  try {
    const res = await fetch("https://ivanm-backend-ok.vercel.app/api/create-checkout", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        producto: "Pack Musical",
        precio: 10
      })
    });

    const data = await res.json();

    if (data.init_point) {
      window.location.href = data.init_point;
    } else {
      alert("Error al iniciar el pago");
    }
  } catch (err) {
    alert("Error de conexi√≥n");
  }
}

/* 2Ô∏è‚É£ VERIFICAR PAGO AL VOLVER */
(async function verificarPago() {
  const params = new URLSearchParams(window.location.search);
  const token = params.get("token");

  if (!token) return;

  try {
    const res = await fetch(
      "https://ivanm-backend-ok.vercel.app/api/verify-payment?token=" + token
    );
    const data = await res.json();

    if (data.valid) {
      document.getElementById("descarga").style.display = "block";
    }
  } catch (err) {
    console.error("Error verificando pago");
  }
})();
</script>

</body>
</html>
